<!DOCTYPE html>
<html lang="zxx">

<head>
	<title>Goggles Ecommerce Category Bootstrap responsive Web Template | Checkout :: w3layouts</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	<meta name="keywords" content="Goggles a Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template, 
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />

	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>



	<link href="/assets/css/bootstrap.css" rel='stylesheet' type='text/css' />
	<link href="/assets/css/login_overlay.css" rel='stylesheet' type='text/css' />
	<link href="/assets/css/style6.css" rel='stylesheet' type='text/css' />
	<link rel="stylesheet" href="/assets/css/shop.css" type="text/css" />
	<link rel="stylesheet" type="text/css" href="/assets/css/checkout.css">
	<link href="/assets/css/easy-responsive-tabs.css" rel='stylesheet' type='text/css' />
	<link href="/assets/css/style.css" rel='stylesheet' type='text/css' />
	<link href="/assets/css/fontawesome-all.css" rel="stylesheet">
	<link href="//fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet">
	<link
		href="//fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800"
		rel="stylesheet">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

	<style>
		.return-button {
			background-color: rgb(206, 57, 57);
			color: white;
			width: 100px;
			height: 40px;
			border: none;
			outline: none;
		}

		.reasonHead {
			font-size: large;
			font-weight: bold;
		}

		.modal {
			display: none;
			/* Hidden by default */
			position: fixed;
			/* Stay in place */
			z-index: 1000;
			/* Sit on top */
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.5);
			/* Black background with opacity */
			overflow: auto;
			/* Enable scroll if needed */
		}

		/* Modal content */
		.modal-content {
			background-color: #fefefe;
			margin: 15% auto;
			/* 15% from the top and centered */
			padding: 20px;
			border: 1px solid #888;
			width: 50%;
			/* Adjust width as needed */
			border-radius: 10px;
		}

		/* Close button */
		.close {
			color: #aaa;
			float: right;
			font-size: 28px;
			font-weight: bold;
		}

		.close:hover,
		.close:focus {

			text-decoration: none;
			cursor: pointer;
		}

		/* Modal form */
		#returnForm {
			text-align: center;
		}

		#returnReason {
			width: 100%;
			height: 100px;
			margin-bottom: 10px;
			outline: none;
			border: none;
		}

		button[type="submit"] {
			background-color: #4CAF50;
			color: white;
			padding: 10px 20px;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			transition: background-color 0.3s;
		}

		button[type="submit"]:hover {
			background-color: #45a049;
		}

		.cancel-button {
			background-color: rgb(206, 57, 57);
			color: white;
			width: 100px;
			height: 40px;
			border: none;
			outline: none;
		}

		.image11 {


			width: 150px;
			height: auto;

		}

		.subtotal {
			margin-top: 20px;
			font-weight: bold;

		}

		.backToShop {
			background-color: black;
			color: white;
			width: 200px;
			height: 50px;
			margin-top: 50px;
			border: none;
			outline: none;
		}
	</style>


</head>

<body>

	<div class="banner-top container-fluid" id="home">
		<!-- header -->
		<header>
			<div class="row">
				<div class="col-md-3 top-info text-left mt-lg-4">
					<h6>Need Help</h6>
					<ul>
						<li>
							<i class="fas fa-phone"></i> Call
						</li>
						<li class="number-phone mt-3">12345678099</li>
					</ul>
				</div>
				<div class="col-md-6 logo-w3layouts text-center">
					<h1 class="logo-w3layouts">
						<a class="navbar-brand" href="index.html">
							Quix </a>
					</h1>
				</div>

				<div class="col-md-3 top-info-cart text-right mt-lg-4">
					<ul class="cart-inner-info">
						<li class="">
							<a class="btn-open" href="/userProfile">
								<span class="fa fa-user"></span>
							</a>
						</li>
						<li class="galssescart galssescart2 cart cart box_1">
							<form action="/loadCart" class="last">

								<button class="top_googles_cart" name="submit" value="">
									My Cart
									<i class="fas fa-cart-arrow-down"></i>
								</button>
							</form>
						</li>
					</ul>

					<div class="search">
						<div class="">
							<button id="trigger-overlay" type="button">
								<i class="fas fa-search"></i>
							</button>
						</div>
						<!-- open/close -->
						<div class="overlay overlay-door">
							<button type="button" class="overlay-close">
								<i class="fa fa-times" aria-hidden="true"></i>
							</button>
							<form action="#" method="post" class="d-flex">
								<input class="form-control" type="search" placeholder="Search here..." required="">
								<button type="submit" class="btn btn-primary submit">
									<i class="fas fa-search"></i>
								</button>
							</form>

						</div>
						<!-- open/close -->
					</div>
					<!---->
					<div class="overlay-login text-left">
						<button type="button" class="overlay-close1">
							<i class="fa fa-times" aria-hidden="true"></i>
						</button>
						<div class="wrap">
							<h5 class="text-center mb-4">Login Now</h5>
							<div class="login p-5 bg-dark mx-auto mw-100">
								<form action="#" method="post">
									<div class="form-group">
										<label class="mb-2">Email address</label>
										<input type="email" class="form-control" id="exampleInputEmail1"
											aria-describedby="emailHelp" placeholder="" required="">
										<small id="emailHelp" class="form-text text-muted">We'll never share your email
											with anyone else.</small>
									</div>
									<div class="form-group">
										<label class="mb-2">Password</label>
										<input type="password" class="form-control" id="exampleInputPassword1"
											placeholder="" required="">
									</div>
									<div class="form-check mb-2">
										<input type="checkbox" class="form-check-input" id="exampleCheck1">
										<label class="form-check-label" for="exampleCheck1">Check me out</label>
									</div>
									<button type="submit" class="btn btn-primary submit mb-4">Sign In</button>

								</form>
							</div>
							<!---->
						</div>
					</div>
					<!---->
				</div>
			</div>

			<label class="top-log mx-auto"></label>
			<nav class="navbar navbar-expand-lg navbar-light bg-light top-header mb-2">

				<button class="navbar-toggler mx-auto" type="button" data-toggle="collapse"
					data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
					aria-label="Toggle navigation">
					<span class="navbar-toggler-icon">

					</span>
				</button>



				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav nav-mega mx-auto">
						<li class="nav-item">
							<a class="nav-link ml-lg-0" href="/home">Home
								<span class="sr-only">(current)</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/about">About</a>
						</li>
						<li class="nav-item ">
							<a class="nav-link" href="/features" id="" role="button" aria-expanded="false">
								Features
							</a>

						</li>
						<li class="nav-item  ">
							<a class="nav-link " href="/products" id="" role="button">
								Shop
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/contact">Contact</a>
						</li>

					</ul>

				</div>
		</header>
		<!-- banner -->
		<div class="banner_inner">
			<div class="services-breadcrumb">
				<div class="inner_breadcrumb">

					<ul class="short">
						<li>
							<a href="/home">Home</a>
							<i>|</i>
						</li>
						<li>Checkout </li>
					</ul>
				</div>
			</div>

		</div>
		<!--//banner -->
	</div>
	<!--// header_top -->
	<!--checkout-->
	<section class="banner-bottom-wthreelayouts py-lg-5 py-3">
		<div class="container">
			<div class="inner-sec-shop px-lg-4 px-3">
				<h3 class="tittle-w3layouts my-lg-4 mt-3">Order Details</h3>
				<div class="checkout-right">
					<section class="banner-bottom-wthreelayouts py-lg-5 py-3">
						<div class="container">
							<div class="inner-sec-shop px-lg-4 px-3">

								<div class="checkout-right">

									<table class="timetable_sub">

										<thead>
											<tr>
												<th>#</th>
												<th>Image</th>
												<th>Name</th>
												<th>Quantity</th>
												<th></th>
												<th>status</th>

											</tr>
										</thead>
										<tbody>
											<% for (let i=0; i < order.products.length; i++) { %>
												<tr>
													<td>
														<%= i + 1 %>
													</td>
													<td>
														<img src="/uploads/<%= order.products[i].productId.images[0] %>"
															alt="<%= order.products[i].productId.name %>"
															class="img-thumbnail image11 img-fluid">
													</td>
													<td>
														<%= order.products[i].productId.productName %>
															<% if (order.products[i].status==="delivered" ) { %>
																<% if (order.products[i].hasReviewed) { %>
																	<div>Thank you for your review!</div>
																	<% } else { %>
																		<div>
																			<form action="/loadReview" method="post">
																				<input type="hidden" name="productId"
																					value="<%= order.products[i].productId._id %>">
																				<input type="hidden" name="orderId"
																					value="<%= orderId %>">
																				<button type="submit"
																					class="btn btn-dark">Add Rating and
																					review</button>
																			</form>
																		</div>
																		<% } %>
																			<% } %>
													</td>
													<td>
														<%= order.products[i].quantity %>
													</td>

													<td id="action_<%= order.products[i].productId._id %>">

														<% if (order.products[i].status==="delivered" ) { %>
															<% const deliveryDate=new
																Date(order.products[i].deliveryDate); %>
																<% const twoWeeksAgo=new Date(); %>
																	<% twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
																		%>

																		<% if (deliveryDate> twoWeeksAgo) { %>
																			<button
																				class="return-button">Return</button>
																			<!-- Add a modal -->
																			<div id="returnModal" class="modal">
																				<div class="modal-content">
																					<span class="close">&times;</span>
																					<h2 class="reasonHead">Reason for
																						Return</h2>
																					<form id="returnForm">
																						<textarea id="returnReason"
																							placeholder="Enter reason for return"
																							required></textarea>
																						<button type="submit"
																							onclick="returnProduct('<%= order.products[i].productId._id %>', '<%= order._id %>', '<%= order.userId._id %>')">Submit</button>
																					</form>
																				</div>
																			</div>
																			<% } %>
																				<% } else if
																					(order.products[i].status==="shipped"
																					||
																					order.products[i].status==="pending"
																					) { %>

																					<button
																						onclick="cancelProduct('<%= order.products[i].productId._id %>', '<%= order._id %>', '<%= order.userId._id %>')"
																						class="cancel-button">Cancel</button>
																					<% } else { %>

																						<p></p>

																						<% } %>
													</td>
													<td>
														<%= order.products[i].status %>
													</td>


												</tr>
												<% } %>
										</tbody>
									</table>




								</div>

								<div class="container">
									<div class="row justify-content-center">
										<div class="col-md-8 text-center">
											<h5 id="subtotal" class="subtotal">Subtotal: <%= order.subTotal.toFixed(2)%>
											</h5>
										</div>
									</div>

									<div class="row justify-content-center mt-4">
										<div class="col-md-8">
											<div class="card">
												<div class="card-body">
													<h5 class="card-title text-center mb-4">Shipping Address</h5>
													<p>
														<%= order.shippingAddress.fullName %><br>
															<%= order.shippingAddress.houseName %><br>
																<%= order.shippingAddress.city %>, <%=
																		order.shippingAddress.state %> - <%=
																			order.shippingAddress.pinCode %><br>
																			<%= order.shippingAddress.country %><br>
																				Mobile: <%= order.shippingAddress.mobile
																					%>
													</p>

												</div>
											</div>
											<form action="/products">
												<button type="submit" class="backToShop">Back to shopping</button>
											</form>
										</div>
									</div>
								</div>




							</div>

						</div>
					</section>


				</div>
				<div class="checkout-left row">


				</div>

			</div>

		</div>
	</section>
	<!--//checkout-->
	<!--footer -->
	<footer class="py-lg-5 py-3">
		<div class="container-fluid px-lg-5 px-3">
			<div class="row footer-top-w3layouts">
				<div class="col-lg-3 footer-grid-w3ls">
					<div class="footer-title">
						<h3>About Us</h3>
					</div>
					<div class="footer-text">
						<p>Curabitur non nulla sit amet nislinit tempus convallis quis ac lectus. lac inia eget
							consectetur sed, convallis at
							tellus. Nulla porttitor accumsana tincidunt.</p>
						<ul class="footer-social text-left mt-lg-4 mt-3">

							<li class="mx-2">
								<a href="#">
									<span class="fab fa-facebook-f"></span>
								</a>
							</li>
							<li class="mx-2">
								<a href="#">
									<span class="fab fa-twitter"></span>
								</a>
							</li>
							<li class="mx-2">
								<a href="#">
									<span class="fab fa-google-plus-g"></span>
								</a>
							</li>
							<li class="mx-2">
								<a href="#">
									<span class="fab fa-linkedin-in"></span>
								</a>
							</li>
							<li class="mx-2">
								<a href="#">
									<span class="fas fa-rss"></span>
								</a>
							</li>
							<li class="mx-2">
								<a href="#">
									<span class="fab fa-vk"></span>
								</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 footer-grid-w3ls">
					<div class="footer-title">
						<h3>Get in touch</h3>
					</div>
					<div class="contact-info">
						<h4>Location :</h4>
						<p>0926k 4th block building, king Avenue, New York City.</p>
						<div class="phone">
							<h4>Contact :</h4>
							<p>Phone : +121 098 8907 9987</p>
							<p>Email :
								<a href="mailto:info@example.com">info@example.com</a>
							</p>
						</div>
					</div>
				</div>
				<div class="col-lg-3 footer-grid-w3ls">
					<div class="footer-title">
						<h3>Quick Links</h3>
					</div>
					<ul class="links">
						<li>
							<a href="index.html">Home</a>
						</li>
						<li>
							<a href="/about">About</a>
						</li>
						<li>
							<a href="404.html">Error</a>
						</li>
						<li>
							<a href="shop.html">Shop</a>
						</li>
						<li>
							<a href="contact.html">Contact Us</a>
						</li>
					</ul>
				</div>
				<div class="col-lg-3 footer-grid-w3ls">
					<div class="footer-title">
						<h3>Sign up for your offers</h3>
					</div>
					<div class="footer-text">
						<p>By subscribing to our mailing list you will always get latest news and updates from us.</p>
						<form action="#" method="post">
							<input class="form-control" type="email" name="Email" placeholder="Enter your email..."
								required="">
							<button class="btn1">
								<i class="far fa-envelope" aria-hidden="true"></i>
							</button>
							<div class="clearfix"> </div>
						</form>
					</div>
				</div>
			</div>
			<div class="copyright-w3layouts mt-4">

			</div>
		</div>
	</footer>
	<!-- //footer -->
	<!--jQuery-->





	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
		// Get the modal
		var modal = document.getElementById("returnModal");

		// Get the button that opens the modal
		var btn = document.getElementsByClassName("return-button");

		// Get the <span> element that closes the modal
		var span = document.getElementsByClassName("close")[0];

		// When the user clicks the button, open the modal 
		for (var i = 0; i < btn.length; i++) {
			btn[i].onclick = function () {
				modal.style.display = "block";
			}
		}

		// When the user clicks on <span> (x), close the modal
		span.onclick = function () {
			modal.style.display = "none";
		}

		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function (event) {
			if (event.target == modal) {
				modal.style.display = "none";
			}
		}


		function returnProduct(productId, orderId, userId) {
			const reason = document.getElementById('returnReason').value;

			fetch('/userReturnOrder', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({
					productId: productId,
					orderId: orderId,
					userId: userId,
					reason: reason
				})
			})
				.then(response => {
					if (!response.ok) {
						throw new Error('Failed to return the order');
					}
					return response.json();
				})
				.then(data => {

					console.log(data);


					const actionCell = document.getElementById('action_' + productId);
					if (actionCell) {
						actionCell.innerHTML = 'Returnded';
					}


					const subtotalElement = document.getElementById('subtotal');
					if (subtotalElement) {
						subtotalElement.innerText = 'Subtotal: ' + data.subTotal;
					}




					Swal.fire({
						icon: 'success',
						title: 'Success!',
						text: 'Product returned successfully',
						timer: 1000,
						showConfirmButton: false
					});



				})
				.catch(error => {

					console.error('Error:', error);

					Swal.fire({
						title: 'Error!',
						text: 'Failed to return product. Please try again later.',
						icon: 'error',
						confirmButtonText: 'OK'
					});
				});
		}


	</script>


	<script>
		function cancelProduct(productId, orderId, userId) {

			Swal.fire({
				title: 'Are you sure?',
				text: 'This action cannot be undone!',
				icon: 'warning',
				showCancelButton: true,
				confirmButtonColor: '#d33',
				cancelButtonColor: '#3085d6',
				confirmButtonText: 'Yes, cancel it!'
			}).then((result) => {
				if (result.isConfirmed) {

					fetch('/userCancelOrder', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({
							productId: productId,
							orderId: orderId,
							userId: userId
						})
					})
						.then(response => {
							if (!response.ok) {
								throw new Error('Failed to cancel order');
							}
							return response.json();
						})
						.then(data => {

							console.log(data);


							const actionCell = document.getElementById('action_' + productId);
							if (actionCell) {
								actionCell.innerHTML = 'Cancelled';
							}


							const subtotalElement = document.getElementById('subtotal');
							subtotalElement.innerText = 'Subtotal: ' + data.subTotal;





							Swal.fire({
								icon: 'success',
								title: 'Success!',
								text: 'Product cancelled successfully',
								timer: 1000,
								showConfirmButton: false
							});



						})
						.catch(error => {
							console.error('Error:', error);
							Swal.fire({
								title: 'Error!',
								text: 'Failed to cancel product. Please try again later.',
								icon: 'error',
								confirmButtonText: 'OK'
							});
						});
				}
			})
		}
	</script>
	<!-- newsletter modal -->
	<!--search jQuery-->
	<script src="/assets/js/modernizr-2.6.2.min.js"></script>
	<script src="/assets/js/classie-search.js"></script>
	<script src="/assets/js/demo1-search.js"></script>
	<!--//search jQuery-->
	<!-- cart-js -->
	<script src="/assets/js/minicart.js"></script>

	<!-- //cart-js -->

	<!-- carousel -->
	<!-- easy-responsive-tabs -->
	<script src="/assets/js/easy-responsive-tabs.js"></script>


	<!--//close-->


	<!-- //dropdown nav -->
	<script src="/assets/js/move-top.js"></script>
	<script src="/assets/js/easing.js"></script>


	<!--// end-smoth-scrolling -->


	<script src="/assets/js/bootstrap.js"></script>


</body>

</html>